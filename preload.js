const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('electronAPI', {
  selectDirectory: () => ipcRenderer.invoke('select-directory'),
  selectDirectories: () => ipcRenderer.invoke('select-directories'),
  selectCover: () => ipcRenderer.invoke('select-cover'),
  selectBackground: () => ipcRenderer.invoke('select-background'),
  getSettings: () => ipcRenderer.invoke('get-settings'),
  getAppVersion: () => ipcRenderer.invoke('get-app-version'),
  normalizeGameTitle: (rawName, options) => ipcRenderer.invoke('normalize-game-title', rawName, options),
  saveSetting: (key, value) => ipcRenderer.invoke('save-setting', key, value),
  setProjectBackground: (sourcePath) => ipcRenderer.invoke('set-project-background', sourcePath),
  clearProjectBackground: () => ipcRenderer.invoke('clear-project-background'),
  importGames: (rootPath) => ipcRenderer.invoke('import-games', rootPath),
  getGames: (params) => ipcRenderer.invoke('get-games', params),
  searchGames: (query, params) => ipcRenderer.invoke('search-games', query, params),
  updateGameAlias: (gameId, alias) => ipcRenderer.invoke('update-game-alias', gameId, alias),
  updateGamePinned: (gameId, pinned) => ipcRenderer.invoke('update-game-pinned', gameId, pinned),
  updateGameCover: (gameId, coverPath) => ipcRenderer.invoke('update-game-cover', gameId, coverPath),
  scrapeGameCover: (gameId) => ipcRenderer.invoke('scrape-game-cover', gameId),
  deleteGame: (gameId, deleteFiles) => ipcRenderer.invoke('delete-game', gameId, deleteFiles),
  getTags: () => ipcRenderer.invoke('get-tags'),
  createTag: (name, color) => ipcRenderer.invoke('create-tag', name, color),
  updateTag: (tagId, name, color) => ipcRenderer.invoke('update-tag', tagId, name, color),
  deleteTag: (tagId) => ipcRenderer.invoke('delete-tag', tagId),
  addTagToGame: (gameId, tagId) => ipcRenderer.invoke('add-tag-to-game', gameId, tagId),
  removeTagFromGame: (gameId, tagId) => ipcRenderer.invoke('remove-tag-from-game', gameId, tagId),
  getGameTags: (gameId) => ipcRenderer.invoke('get-game-tags', gameId),
  getAllTags: () => ipcRenderer.invoke('get-all-tags'),
  getGamesByTag: (tagName, params) => ipcRenderer.invoke('get-games-by-tag', tagName, params),
  openFolder: (folderPath) => ipcRenderer.invoke('open-folder', folderPath),
  showItemInFolder: (filePath) => ipcRenderer.invoke('show-item-in-folder', filePath),
  openExternal: (url) => ipcRenderer.invoke('open-external', url),
  scanExecutables: (rootPaths) => ipcRenderer.invoke('scan-executables', rootPaths),
  launchExecutable: (exePath, rootPaths, gameMeta) => ipcRenderer.invoke('launch-executable', exePath, rootPaths, gameMeta),
  launchExecutableAdmin: (exePath, rootPaths, gameMeta) => ipcRenderer.invoke('launch-executable-admin', exePath, rootPaths, gameMeta),
  launchExecutableLocaleRemulator: (exePath, rootPaths, gameMeta) => ipcRenderer.invoke('launch-executable-locale-remulator', exePath, rootPaths, gameMeta),
  launchExecutableLocaleEmulator: (exePath, rootPaths, gameMeta) => ipcRenderer.invoke('launch-executable-locale-emulator', exePath, rootPaths, gameMeta),
  getRunHistory: (params) => ipcRenderer.invoke('get-run-history', params),
  clearRunHistory: () => ipcRenderer.invoke('clear-run-history'),
  getRootPaths: () => ipcRenderer.invoke('get-root-paths'),
  addRootPath: (path) => ipcRenderer.invoke('add-root-path', path),
  deleteRootPath: (id) => ipcRenderer.invoke('delete-root-path', id),
  addGameDirectory: (path) => ipcRenderer.invoke('add-game-directory', path),
  captureScreenCover: (gameId) => ipcRenderer.invoke('capture-screen-cover', gameId),
  resetDatabase: () => ipcRenderer.invoke('reset-database'),
  getIgnoredGamePaths: () => ipcRenderer.invoke('get-ignored-game-paths'),
  restoreIgnoredGamePaths: (paths) => ipcRenderer.invoke('restore-ignored-game-paths', paths),
  clearIgnoredGamePaths: () => ipcRenderer.invoke('clear-ignored-game-paths')
});
